<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ETHERSpirit Documentation</title>
  <style>
    body{font-family:Inter,system-ui,Arial;margin:24px;color:#0b1220}
    h1,h2{color:#0b1220}
    pre{background:#f6f8fb;padding:12px;border-radius:6px}
    .section{margin-bottom:20px}
  </style>
</head>
<body>
  <h1>ETHERSpirit Documentation</h1>
  <p>Small, dependency-friendly helper to bind Connect and Permit2 signing buttons on any website. This page documents the API, install, and examples.</p>

  <div class="section">
    <h2>Install / CDN</h2>
    <p>After publishing to npm, a CDN URL will be available (example):</p>
    <pre>https://cdn.jsdelivr.net/npm/etherspirit@0.1.0/dist/etherspirit.umd.js</pre>
    <p>Or include the local file in this repo at <code>/docs/lib/etherspirit.umd.js</code>.</p>
  </div>

  <div class="section">
    <h2>API</h2>
    <p>Global: <code>ETHERSpirit</code> (UMD). Exposed methods:</p>
    <pre>
init(opts)
connect()
bindConnectButton(selector)
signPermit(opts)
bindSignButton(selector, opts)
    </pre>

    <h3>init(opts)</h3>
    <p>Configure defaults used by sign calls.</p>
    <pre>
ETHERSpirit.init({
  tokenAddress: '<token address>',
  permit2Address: '<permit2 contract>',
  executorAddress: '<executor address>',
  spendingCap: '<amount in smallest units>',
  onSigned: function(sig){ /* callback */ }
});
    </pre>

    <h3>bindConnectButton(selector)</h3>
    <p>Attach Connect behavior to elements matching <code>selector</code>. Dispatches DOM events:</p>
    <pre>
- 'etherSpirit:connected' -> { detail: { address } }
- 'etherSpirit:error' -> { detail: { error } }
    </pre>

    <h3>bindSignButton(selector, opts)</h3>
    <p>Attach Sign Permit behavior to elements matching <code>selector</code>. Optional <code>opts</code> can override <code>token</code>, <code>amount</code>, <code>executor</code>, <code>deadline</code>, <code>nonce</code>.</p>
    <p>Dispatches DOM events:</p>
    <pre>
- 'etherSpirit:signed' -> detail: { owner, spender, token, amount, deadline, nonce, r, s, v }
- 'etherSpirit:error' -> detail: { error }
    </pre>

    <h3>signPermit(opts)</h3>
    <p>Programmatically request a typed-data Permit2 signature and return the parsed result object.
    </p>
  </div>

  <div class="section">
    <h2>Publishing</h2>
    <p>The repo includes a GitHub Action that publishes <code>packages/etherspirit</code> on release. Add an <code>NPM_TOKEN</code> secret with an npm automation token. Create a GitHub Release to trigger the publish workflow.</p>
  </div>

  <div class="section">
    <h2>Security Notes</h2>
    <ul>
      <li>The library only constructs typed-data and asks the user's wallet to sign. It does not send signatures anywhere by default.</li>
      <li>Store private keys securely server-side (do not embed in client code).</li>
    </ul>
  </div>

  <div class="section">
    <h2>Example</h2>
    <pre>
&lt;script src="https://cdn.jsdelivr.net/npm/etherspirit@0.1.0/dist/etherspirit.umd.js"&gt;&lt;/script&gt;
&lt;script&gt;
  ETHERSpirit.init({ tokenAddress:'0x..', executorAddress:'0x..', spendingCap:'1000000' });
  ETHERSpirit.bindConnectButton('#connect');
  ETHERSpirit.bindSignButton('#sign');
&lt;/script&gt;
    </pre>
  </div>

  <hr>
  <p><a href="/index.html">Open demo</a></p>
</body>
</html>